<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review Merger AI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        body { background-color: #f4f7f6; min-height: 100vh; padding-top: 50px; }
        .card { border-radius: 15px; border: none; box-shadow: 0 8px 24px rgba(0,0,0,0.1); }
        .btn-merge { background: linear-gradient(45deg, #1a2a6c, #b21f1f, #fdbb2d); color: white; border: none; font-weight: bold; }
        .btn-merge:hover { opacity: 0.9; color: white; transform: translateY(-1px); }
        .source-label { font-size: 0.8rem; font-weight: bold; color: #666; text-transform: uppercase; }
        #resultaat-container { display: none; margin-top: 30px; }
    </style>
</head>
<body>

<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-10 col-lg-8">
            <div class="card p-5">
                <div class="text-center mb-4">
                    <h1 class="fw-bold">🚀 Review Merger</h1>
                    <p class="text-muted">Combineer 3 bronnen tot één ultiem aankoopadvies.</p>
                </div>

                <div class="mb-3">
                    <label class="source-label">Bron 1 (bijv. Tweakers Review)</label>
                    <input type="text" class="form-control" id="url1" placeholder="Plak URL hier...">
                </div>
                <div class="mb-3">
                    <label class="source-label">Bron 2 (bijv. YouTube Review)</label>
                    <input type="text" class="form-control" id="url2" placeholder="Plak URL hier...">
                </div>
                <div class="mb-3">
                    <label class="source-label">Bron 3 (bijv. Gebruikerservaring of 2e review)</label>
                    <input type="text" class="form-control" id="url3" placeholder="Plak URL hier...">
                </div>

                <div class="d-grid mt-4">
                    <button class="btn btn-merge btn-lg" onclick="mergeReviews()">Synthetiseer Rapport ✨</button>
                </div>

                <div id="loading" class="text-center mt-4" style="display: none;">
                    <div class="spinner-grow text-primary" role="status"></div>
                    <p class="mt-2 text-muted fst-italic">De softwarelaag orkestreert de bronnen... 🧠</p>
                </div>
            </div>

            <div id="resultaat-container" class="card p-5 mb-5">
                <h2 class="border-bottom pb-3 mb-4 text-primary">📊 Geconsolideerd Rapport</h2>
                <div id="resultaat-tekst"></div>
            </div>
        </div>
    </div>
</div>

<script>
    async function mergeReviews() {
        const urls = [
            document.getElementById('url1').value,
            document.getElementById('url2').value,
            document.getElementById('url3').value
        ].filter(url => url !== ""); // Alleen gevulde velden sturen

        const container = document.getElementById('resultaat-container');
        const resultText = document.getElementById('resultaat-tekst');
        const loading = document.getElementById('loading');

        container.style.display = 'none';
        loading.style.display = 'block';

        try {
            const response = await fetch('/merge-reviews', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ urls: urls })
            });

            const data = await response.json();
            loading.style.display = 'none';
            
            if (data.error) {
                alert("Fout: " + data.error);
            } else {
                resultText.innerHTML = marked.parse(data.resultaat);
                container.style.display = 'block';
            }
        } catch (e) {
            loading.style.display = 'none';
            alert("Verbindingsfout");
        }
    }
</script>

</body>
</html>